---
import { Image } from "astro:assets";
import consoleImage from "../../assets/accueil/hero-flight-case.png";

const realisations = [
    {
        title: "Meubles",
        imagePosition: "left",
        bgColor: "bg-[#525946]/20",
        image: consoleImage,
    },
    {
        title: "Evenementiel",
        imagePosition: "right",
        bgColor: "bg-transparent",
        image: consoleImage,
    },
    {
        title: "Industrie",
        imagePosition: "left",
        bgColor: "bg-[#525946]/20",
        image: consoleImage,
    },
    {
        title: "Spectacle",
        imagePosition: "right",
        bgColor: "bg-transparent",
        image: consoleImage,
    },
    {
        title: "Audiovisuel",
        imagePosition: "left",
        bgColor: "bg-[#525946]/20",
        image: consoleImage,
    },
    {
        title: "Pelicase",
        imagePosition: "right",
        bgColor: "bg-transparent",
        image: consoleImage,
    },
];
---

<section
    id="realisations"
    class="realisations-section w-full min-h-screen py-12 md:py-20 px-0"
>
    <div
        class="w-full max-w-5xl mx-auto text-center mb-8 md:mb-12 px-6 md:px-8"
    >
        <h2
            class="text-2xl sm:text-3xl md:text-5xl lg:text-7xl font-bold mb-3 md:mb-4 mt-6 md:mt-8 tracking-tight"
        >
            Nos réalisations
        </h2>
        <p
            class="text-sm sm:text-base md:text-xl lg:text-2xl text-white/70 font-light"
        >
            Découvrez la diversité de nos projets pour différents secteurs
        </p>
    </div>

    <div class="flex flex-col gap-0 w-full">
        {
            realisations.map((item) => (
                <div
                    class={`realisation-card ${item.bgColor} py-12 md:py-32 px-6 md:px-12`}
                >
                    <div
                        class={`w-full px-4 md:px-12 mx-auto flex flex-col md:flex-row items-center gap-12 md:gap-20 ${item.imagePosition === "right" ? "md:flex-row-reverse" : ""}`}
                    >
                        <div class="w-full md:flex-1 flex-shrink-0">
                            {item.image ? (
                                <div class="w-full overflow-hidden rounded-lg shadow-lg">
                                    <Image
                                        src={item.image}
                                        alt={item.title}
                                        loading="lazy"
                                        decoding="async"
                                        widths={[400, 800, 1200]}
                                        sizes="(max-width: 768px) 100vw, 50vw"
                                        class="w-full h-auto object-cover transition-transform duration-500 hover:scale-[1.02]"
                                    />
                                </div>
                            ) : (
                                <div class="bg-gray-800 rounded-lg aspect-[4/3] w-full transition-transform duration-500 hover:scale-[1.02]" />
                            )}
                        </div>

                        <div class="w-full md:flex-1 text-reveal text-center md:px-8">
                            <h3 class="text-3xl md:text-5xl font-bold mb-4 md:mb-6 text-[#d4d4d4] tracking-tight">
                                {item.title}
                            </h3>
                        </div>
                    </div>
                </div>
            ))
        }
    </div>

    <div class="w-full flex justify-center mt-10 md:mt-16">
        <a
            href="/404"
            class="cta-button group relative inline-flex items-center justify-center px-10 sm:px-12 md:px-16 py-3 overflow-hidden rounded-full bg-[#525946] border-2 border-[#6b755a] shadow-[0_6px_20px_rgba(82,89,70,0.5)] transition-all
            duration-300 hover:scale-105 hover:shadow-[0_8px_30px_rgba(82,89,70,0.7)] whitespace-nowrap no-underline opacity-0 translate-y-10"
        >
            <span
                class="absolute inset-0 w-full h-full bg-gradient-to-br from-white/20 to-transparent opacity-50"
            ></span>
            <span
                class="relative text-white font-bold text-lg md:text-xl tracking-wider"
            >
                Voir plus
            </span>
        </a>
    </div>
</section>

<style>
    y .text-reveal {
        mask-image: linear-gradient(to right, black 50%, transparent 100%);
        mask-size: 200% 100%;
        mask-position: 100% 0;
        mask-repeat: no-repeat;
        -webkit-mask-image: linear-gradient(
            to right,
            black 50%,
            transparent 100%
        );
        -webkit-mask-size: 200% 100%;
        -webkit-mask-position: 100% 0;
        -webkit-mask-repeat: no-repeat;
        opacity: 0;
    }
</style>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    const cards = document.querySelectorAll(".realisation-card");
    const ctaButton = document.querySelector(".cta-button");

    cards.forEach((card) => {
        const textContent = card.querySelector(".text-reveal");

        if (textContent) {
            gsap.to(textContent, {
                scrollTrigger: {
                    trigger: textContent,
                    start: "top 60%",
                    toggleActions: "play none none reverse",
                },
                opacity: 1,
                maskPosition: "0% 0",
                webkitMaskPosition: "0% 0",
                duration: 1.5,
                ease: "power2.inOut",
            });
        }
    });

    if (ctaButton) {
        gsap.to(ctaButton, {
            scrollTrigger: {
                trigger: ctaButton,
                start: "top 90%",
                toggleActions: "play none none reverse",
            },
            opacity: 1,
            y: 0,
            duration: 0.8,
            ease: "back.out(1.7)",
        });
    }
</script>
